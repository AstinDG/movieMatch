<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
              integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
              crossorigin="anonymous">
        <title>Edit Movie</title>
    </head>
    <body>
        <header class="header container-fluid bg-dark ">
            <div class="row">
                <div class="col-sm-2">
                    <a class="link-light link-offset-2 link-underline link-underline-opacity-0 link-underline-opacity-75-hover"
                       href="/admin" style="padding: 25px;display:block;">Main</a>
                </div>
                <div class="col-sm-2">
                    <a class="link-light link-offset-2 link-underline link-underline-opacity-0 link-underline-opacity-75-hover"
                       href="/admin/movie" style="padding: 25px;display:block;">Back to list</a>
                </div>
                <div class="col-sm-2">
                    <a class="link-light link-offset-2 link-underline link-underline-opacity-0 link-underline-opacity-75-hover"
                       th:href="@{/admin/movie/{id}(id=${movie.getId()})}" style="padding: 25px;display:block;">Back to
                        movie</a>
                </div>
            </div>
        </header>

        <div th:if="${movieIsPresent}"
             class="movie container">
            <h4>Year of release: [[${movie.getYearOfRelease()}]]</h4>
            <form id="movieYearOfReleaseForm" th:method="PATCH"
                  th:action="@{/admin/movie/{id}/updateYearRelease(id=${movie.getId()})}">
                <label for="yearOfRelease">Select year of release: </label>
                <select th:object="${movie}" th:field="*{yearOfRelease}" id="yearOfRelease">
                    <option th:each="year: ${#numbers.sequence(1900,2080)}" th:value="${year}"
                            th:text="${year}"></option>
                </select>
                <input type="submit" value="Set year of release!"/>
            </form>
            <h3>English details</h3>
            <form id="movieDetailsEnForm" th:method="PATCH"
                  th:action="@{/admin/movie/{id}/updateDetailsEn(id=${movie.getId()})}"
                  th:object="${movieDetailsEn}" enctype="multipart/form-data">

                <label for="name">Enter name: </label>
                <input type="text" th:field="*{name}" id="name"/>
                <div style="color:red" th:if="${#fields.hasErrors('name')}" th:errors="*{name}">Name Error</div>
                <br/>

                <label for="currentImageEn">Current photo: </label>
                <img id="currentImageEn" th:src="@{'data:image/jpeg;base64,'+${movieDetailsEn.generateBase64Image()}}" style="width:200px;height:300px;"/>
                <label for="imageEn">Update photo:</label>
                <input type="file" id="imageEn" name="imageEn" accept="image/*" class="form-control-file">
                <div style="color:red" th:if="${#fields.hasErrors('image')}" th:errors="*{description}">Image Error
                </div>
                <br/>

                <label for="description">Enter description: </label>
                <br/>
                <textarea th:field="*{description}" id="description" cols="30" rows="20"></textarea>
                <div style="color:red" th:if="${#fields.hasErrors('description')}" th:errors="*{description}">
                    Description Error
                </div>
                <br/>
                <br/>
                <input type="submit" value="Update English Details">
            </form>
            <br/>
            <br/>
            <br/>


            <h3>Подробиці українською</h3>

            <form id="movieDetailsUaForm" th:method="PATCH"
                  th:action="@{/admin/movie/{id}/updateDetailsUa(id=${movie.getId()})}"
                  th:object="${movieDetailsUa}" enctype="multipart/form-data">

                <label for="nameUa">Назва: </label>
                <input type="text" th:field="*{name}" id="nameUa"/>
                <div style="color:red" th:if="${#fields.hasErrors('name')}" th:errors="*{name}">Name Error</div>
                <br/>

                <label for="currentImageUa">Поточна картинка: </label>
                <img id="currentImageUa" th:src="@{'data:image/jpeg;base64,'+${movieDetailsUa.generateBase64Image()}}" style="width:200px;height:300px;"/>
                <label for="imageUa">Оновити картинку: </label>
                <input type="file" id="imageUa" name="imageEn" accept="image/*" class="form-control-file">
                <div style="color:red" th:if="${#fields.hasErrors('image')}" th:errors="*{description}">Image Error
                </div>
                <br/>

                <label for="descriptionUa">Опис фільму: </label>
                <br/>
                <textarea th:field="*{description}" id="descriptionUa" cols="30" rows="20"></textarea>
                <div style="color:red" th:if="${#fields.hasErrors('description')}" th:errors="*{description}">
                    Description Error
                </div>
                <br/>
                <br/>
                <input type="submit" value="Оновити подробиці!"/>
            </form>
            <br/>
            <br/>

            <h3>Подробности на русском</h3>
            <form id="movieDetailsRuForm" th:method="PATCH"
                  th:action="@{/admin/movie/{id}/updateDetailsRu(id=${movie.getId()})}"
                  th:object="${movieDetailsRu}" enctype="multipart/form-data">

                <label for="nameRu">Названаие: </label>
                <input type="text" th:field="*{name}" id="nameRu"/>
                <div style="color:red" th:if="${#fields.hasErrors('name')}" th:errors="*{name}">Name Error</div>
                <br/>

                <label for="currentImageRu">Текущая картинка: </label>
                <img id="currentImageRu" th:src="@{'data:image/jpeg;base64,'+${movieDetailsRu.generateBase64Image()}}" style="width:200px;height:300px;"/>
                <label for="imageRu">Оновити картинку: </label>
                <input type="file" id="imageRu" name="imageEn" accept="image/*" class="form-control-file">
                <div style="color:red" th:if="${#fields.hasErrors('image')}" th:errors="*{description}">Image Error
                </div>
                <br/>

                <label for="descriptionRu">Описание фильма: </label>
                <br/>
                <textarea th:field="*{description}" id="descriptionRu" cols="30" rows="20"></textarea>
                <div style="color:red" th:if="${#fields.hasErrors('description')}" th:errors="*{description}">
                    Description Error
                </div>
                <br/>
                <br/>
                <input type="submit" value="Обновить подробности!"/>
            </form>
            <br/>
            <br/>

            <h3>Genres</h3>
            <form id="movieGenresForm" th:method="PATCH"
                  th:action="@{/admin/movie/{id}/updateGenres(id=${movie.getId()})}"
                  th:object="${movie}">
                <ul>
                    <li th:each="genre: ${genreMap.keySet()}">
                        <input type="checkbox"
                               th:field="*{genres}"
                               th:value="${genre}"/>
                        <label
                                th:for="${#ids.prev('genres')}"
                                th:text="${genreMap.get(genre)}"></label>
                    </li>
                </ul>
                <input type="submit" value="Update genres!"/>
            </form>
        </div>


        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
                integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
                crossorigin="anonymous"></script>
    </body>
</html>